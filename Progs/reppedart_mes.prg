*         1         2         3         4         5         6         7         8         9         1         1         2         3         4         5         6         7         8         9         2         1         2         3         4
*123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
*Articulo                                                        TOTAL        ENERO      FEBRERO        MARZO        ABRIL         MAYO        JUNIO        JULIO       AGOSTO    SETIEMBRE      OCTUBRE     NOVIMBRE    DICIEMBRE
*12345678901234567890123456789012345678901234567890 123 999,999,999.99 99,999,999.99 99,999,999.99 99,999,999.99 99,999,999.99 99,999,999.99 99,999,999.99 99,999,999.99 99,999,999.99 99,999,999.99 99,999,999.99 99,999,999.99 99,999,999.99

*AUXILIAR                                          TOTAL          ENERO        FEBRERO          MARZO          ABRIL           MAYO          JUNIO          JULIO         AGOSTO      SETIEMBRE        OCTUBRE       NOVIMBRE      DICIEMBRE
*12345678 123456789012345678901234567890  999,999,999.99 999,999,999.99 999,999,999.99 999,999,999.99 999,999,999.99 999,999,999.99 999,999,999.99 999,999,999.99 999,999,999.99 999,999,999.99 999,999,999.99 999,999,999.99 999,999,999.99                      

*PARAMETERS lcPeriodoIni, lcPeriodo, lnIndNiv, lnIndMnd, lnIndOpc
PUBLIC lnPag, R
LOCAL lcFile, lcProceso
lcFile = "VtaCliMes"
lcProceso = "Rep_PedArtMes()"
lnPag = 0
R = 0
Imprimetexto(lcFile,lcProceso)
RETURN

PROCEDURE Rep_PedArtMes()
LOCAL lnTOT,ln01,ln02,ln03,ln04,ln05,ln06,ln07,ln08,ln09,ln10,ln11,ln12
@PROW(),PCOL() SAY CHR(27)+"C"+CHR(66) 
@PROW(),PCOL() SAY CHR(18)+CHR(15)
STORE 0 TO lnTOT,ln01,ln02,ln03,ln04,ln05,ln06,ln07,ln08,ln09,ln10,ln11,ln12
TIT_PedArtMes()

SELE TmpSel
GO TOP
SCAN WHILE !EOF()
	R = R + 1
	IF R > 55
		TIT_PedArtMes()
		R = R + 1
	ENDIF
	@R,001 SAY PADR(DesArt,50)
	@R,052 SAY PADR(CodArt,3)
	@R,056 SAY Total PICTURE "@Z 999,999,999.99"
	@R,071 SAY Ene PICTURE "@Z 99,999,999.99"
	@R,085 SAY Feb PICTURE "@Z 99,999,999.99"
	@R,099 SAY Mar PICTURE "@Z 99,999,999.99"
	@R,113 SAY Abr PICTURE "@Z 99,999,999.99"
	@R,127 SAY May PICTURE "@Z 99,999,999.99"
	@R,141 SAY Jun PICTURE "@Z 99,999,999.99"
	@R,155 SAY Jul PICTURE "@Z 99,999,999.99"
	@R,169 SAY Ago PICTURE "@Z 99,999,999.99"
	@R,183 SAY Sep PICTURE "@Z 99,999,999.99"
	@R,197 SAY Oct PICTURE "@Z 99,999,999.99"
	@R,211 SAY Nov PICTURE "@Z 99,999,999.99"
	@R,225 SAY Dic PICTURE "@Z 99,999,999.99"
	ln01 = ln01 + Ene
	ln02 = ln02 + Feb
	ln03 = ln03 + Mar
	ln04 = ln04 + Abr
	ln05 = ln05 + May
	ln06 = ln06 + Jun
	ln07 = ln07 + Jul
	ln08 = ln08 + Ago
	ln09 = ln09 + Sep
	ln10 = ln10 + Oct
	ln11 = ln11 + Nov
	ln12 = ln12 + Dic
	lnTot = lnTot + Total
ENDSCAN
R = R + 1
@R,001 SAY REPLICATE("-",240)
R = R + 1
@R,001 SAY PADR("TOTAL GENERAL",30)
@R,056 SAY lnTot PICTURE "@Z 999,999,999.99"
@R,071 SAY ln01 PICTURE "@Z 99,999,999.99"
@R,085 SAY ln02 PICTURE "@Z 99,999,999.99"
@R,099 SAY ln03 PICTURE "@Z 99,999,999.99"
@R,113 SAY ln04 PICTURE "@Z 99,999,999.99"
@R,127 SAY ln05 PICTURE "@Z 99,999,999.99"
@R,141 SAY ln06 PICTURE "@Z 99,999,999.99"
@R,155 SAY ln07 PICTURE "@Z 99,999,999.99"
@R,169 SAY ln08 PICTURE "@Z 99,999,999.99"
@R,183 SAY ln09 PICTURE "@Z 99,999,999.99"
@R,197 SAY ln10 PICTURE "@Z 99,999,999.99"
@R,211 SAY ln11 PICTURE "@Z 99,999,999.99"
@R,225 SAY ln12 PICTURE "@Z 99,999,999.99"
R = R + 1
@R,001 SAY REPLICATE("=",240)
RETURN

PROCEDURE TIT_PedArtMes()
lnPag =lnPag + 1
IF lnPag > 1
	@00,00 SAY ""
ENDIF
@01,001 SAY PADR(TabPar.NomEmp,40)
@01,042 SAY PADC(pTitNom,176)
@01,220 SAY DATE()
@02,042 SAY PADC(pTitRng,176)
@02,220 SAY TIME()
@03,001 SAY PADR("RUC "+ALLTRIM(TabPar.NroRuc),40)
@03,042 SAY PADC(pTitMnd,176)
@03,220 SAY ALLTRIM(STR(pPagAnt+lnPag))
@04,001 SAY REPLICATE("-",240)
@05,001 SAY "ARTICULO"
@05,056 SAY PADL("TOTAL",14)
@05,071 SAY PADL("ENERO",13) 
@05,085 SAY PADL("FEBRERO",13)
@05,099 SAY PADL("MARZO",13) 
@05,113 SAY PADL("ABRIL",13) 
@05,127 SAY PADL("MAYO",13) 
@05,141 SAY PADL("JUNIO",13) 
@05,155 SAY PADL("JULIO",13) 
@05,169 SAY PADL("AGOSTO",13) 
@05,183 SAY PADL("SEPTIEMBRE",13) 
@05,197 SAY PADL("OCTUBRE",13)
@05,211 SAY PADL("NOVIEMBRE",13) 
@05,225 SAY PADL("DICIEMBRE",13) 
@06,001 SAY REPLICATE("-",240)
R=6
RETURN