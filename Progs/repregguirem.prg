*         1         2         3         4         5         6         7         8         9         0         1         2         3         4         5         6         7         8         9         0   
*12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
*REGISTRO DE GUIAS
*GUIA        FECHA      SIT  CLIENTE                        ALMACEN    ALMACEN       FACTURA    FACTURA        PEDIDO     PEDIDO
*DOCUMENTO   EMISON                                         FECHA      DOCUMENTO     FECHA      DOCUMENTO                 FECHA
*123-1234567 12/12/1234 1234 123456789012345678901234567890 12/12/1234 12-1234567890 12/12/1234 123-1234567890 1234567890 12/12/1234          
*123-1234567 12/12/1234 1234 123456789012345678901234567890 12/12/1234 12-1234567890 12/12/1234 123-1234567890

PUBLIC lnPag, R
LOCAL lcFile, lcProceso
lcFile = "RegGuiRem"
lcProceso = "Rep_RegGuiRem()"
lnPag = 0
R = 0
Imprimetexto(lcFile,lcProceso)
RETURN

PROCEDURE REP_RegGuiRem
LOCAL lnDoc
*-
@0,0 SAY CHR(18)+CHR(15)
*-
TIT_RegGuiRem()
*-
STORE 0 TO lnDoc
SELE TmpRep
GO TOP 
DO WHILE !EOF()
	R = R + 1
	IF R > 55
		TIT_RegGuiRem()
		R = R + 1
	ENDIF
	@R,001 SAY TRANSFORM(NroDoc,"@R 999-9999999")
	@R,013 SAY FecDoc
	DO CASE 
	CASE IndSit == 1
		@R,024 SAY PADR("PENDIENTE",03)
	CASE IndSit == 3
		@R,024 SAY PADR("DESPACHADA",03)
	CASE IndSit == 4
		@R,024 SAY PADR("FACTURADA",03)
	CASE IndSit == 9
		@R,024 SAY PADR("ANULADA",03)
	ENDCASE
	@R,029 SAY PADR(NomAux,30)
	@R,060 SAY FecGuiAlm
	@R,071 SAY TipDocAlm+"-"+PADR(NroGuiAlm,10)
	@R,085 SAY FecFac
	@R,096 SAY TRANSFORM(NroFac,"@R 999-99999999")
	@R,111 SAY PADR(NroPed,10)
	@R,122 SAY FecPed
	lnDoc = lnDoc + 1
	SKIP
ENDDO
R = R + 1
@R,001 SAY REPLICATE("-",132)
R = R + 1
@R,001 SAY "TOTAL DOCUMENTOS : "
@R,020 SAY lnDoc PICTURE "@Z 999,999"
R = R + 1
@R,001 SAY REPLICATE("-",132)
RETURN

PROCEDURE TIT_RegGuiRem()
lnPag =lnPag + 1
IF lnPag > 1
	@00,00 SAY ""
ENDIF
@01,001 SAY PADR(TabPar.NomEmp,40)
@01,042 SAY PADC(pTitNom,76)
@01,120 SAY DATE()
@02,001 SAY PADR("RUC : "+TabPar.NroRuc,40)
@02,042 SAY PADC(pTitRng,76)
@02,120 SAY TIME()
@03,042 SAY PADC(pTitMnd,76)
@03,120 SAY lnPag PICTURE "@B 9999"
@04,001 SAY REPLICATE("-",132)
@05,001 SAY "GUIA"
@05,013 SAY "FECHA"
@05,024 SAY "SIT"
@05,029 SAY "CLIENTE"
@05,060 SAY "ALMACEN"
@05,071 SAY "ALAMCEN"
@05,085 SAY "FACTURA"
@05,096 SAY "FACTURA"
@05,111 SAY "PEDIDO"
@05,122 SAY "PEDIDO"
@06,060 SAY "FECHA"
@06,071 SAY "GUIA"
@06,085 SAY "FECHA"
@06,096 SAY "DOCUMENTO"
@06,122 SAY "FECHA"
@07,001 SAY REPLICATE("-",132)
R=8
RETURN