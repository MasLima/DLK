*SELECT A.NROSEC, A.TIPDOC, A.NRODOC, A.FECDOC, A.SECREF, A.TIPREF, A.NROREF, A.FECREF FROM TMPREF A LEFFT
SET DELETE ON
SET EXCLUSIVE OFF
SET MULTILOCKS ON
SET CENTURY ON
SET DATE TO DMY
SET HOURS TO 24

SET SAFETY OFF
SET ESCAPE OFF


*!*	SELECT A.FECDOC, A.NROSEC, A.TIPDOC, A.NRODOC, A.TIPAUX, A.CODAUX, A.IMPTOT ;
*!*	FROM PEDCAB A WHERE BETWEEN(A.FECDOC,CTOD("01/06/2014"),CTOD("30/06/2014")) INTO CURSOR TMPPED

*SELECT A.NROSEC, SUM(D.TOTMAR) AS TOTMAR  FROM TMPPED A LEFT OUTER JOIN PEDDET D ON A.NROSEC == D.NROSEC GROUP BY A.NROSEC ORDER BY A.NROSEC INTO CURSOR TMPMAR

*!*	SELECT A.FECDOC, A.NROSEC, A.TIPDOC, A.NRODOC, A.TIPAUX, A.CODAUX, A.IMPTOT, NVL(B.TOTMAR,000000000.00) AS TOTMAR ;
*!*	FROM TMPPED A LEFT OUTER JOIN TMPMAR B ON A.NROSEC == B.NROSEC INTO CURSOR TMPPED
*!*	USE IN TMPMAR


SELECT A.*, B.NROSEC AS SECREF, B.TIPDOC AS TIPREF, B.NRODOC AS NROREF, B.FECDOC AS FECREF, B.FecVen, B.IMPTOT AS IMPREF ;
FROM TMPPED A LEFT OUTER JOIN DOCCAB B ON A.NROSEC == B.NROSECREF AND A.TIPDOC == B.TIPDOCREF AND A.NRODOC == B.NRODOCREF AND !(B.INDSIT == 9) ORDER BY A.TIPDOC, A.NRODOC INTO CURSOR TMPREF

SELECT * FROM TMPREF ORDER BY FECDOC, FECREF INTO CURSOR TMPREF
RETURN