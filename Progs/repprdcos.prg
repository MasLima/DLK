*         1         2         3         4         5         6         7         8         9         0         1         2         3         4         5         6         7         8         9         0                             
*12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890                 
*Codigo     Descripcion                              UND Ord. Prod     Cantidad Prd   Cant Prod         M.P.         M.O.         G.F.        Total         Costo        Venta     Utilidad    %   
*1234567890 1234567890123456789012345678901234567890 123 1234567890 999,999.999 123 999,999.999 99999,999.99 99999,999.99 99999,999.99 99999,999.99 999999.999999 99999,999.99 99999,999.99 999.999 

*1234567890 1234567890123456789012345678901234567890 123
*
*ORD PRODUCCION : 123456789012   Fecha : 12/12/1234

*CANTIDAD       : 999,999.999 UND  FACTOR PROD  : 123456.123456 
*CANTIDAD PROD  : 999,999.999 UND  TOAL X LINEA : 999,999.999 UND  
*MATERI PRIMA   : 99,999,999.99
*MANO OBRA      : 99,999,999.99    TOAL X LINEA : 99,999,999.99
*GASTO FABRICAC : 99,999,999.99    TOAL X LINEA : 99,999,999.99
*TOTAL COSTO    : 99,999,999.99    COSTO X UND  : 99,999,999.999999
*VENTA          : 99,999,999.99    UTILIDAD     : 99,999,999.99  (999.999)%    
*         1         2         3         4         5         6         7         8         9         0         1         2         3         4         5         6         7         8         9         0                             
*12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890                 
*CODIGO     DESCRIPCION                              UND    CANTIDAD           COSTO       TOTAL Documento          Fecha    
*MATERIA PRIMA
*1234567890 1234567890123456789012345678901234567890 XXX 999,999.999 9999,999.999999 9999,999.99 12-123456789012345 12/12/1234 
*1234567890 1234567890123456789012345678901234567890 XXX 999,999.999 99,999.999999 999,999.99 12-123456789012345 12/12/1234 
*1234567890 1234567890123456789012345678901234567890 XXX 999,999.999 99,999.999999 999,999.99 
*1234567890 1234567890123456789012345678901234567890 XXX 999,999.999 99,999.999999 999,999.99 
*                                                                                  999,999.99
*PRODUCTO TERMINADO
*1234567890 1234567890123456789012345678901234567890 XXX 999,999.999 99,999.999999 999,999.99 12-1234567890 12-123456789012345 
*1234567890 1234567890123456789012345678901234567890 XXX 999,999.999 99,999.999999 999,999.99 12-1234567890 12-123456789012345 
*1234567890 1234567890123456789012345678901234567890 XXX 999,999.999 99,999.999999 999,999.99 12-1234567890 12-123456789012345 
*                                                        999,999.999               999,999.99
*VENTA
*1234567890 1234567890123456789012345678901234567890 XXX 999,999.999 99,999.999999 999,999.99 12-1234567890 12-123456789012345 
*1234567890 1234567890123456789012345678901234567890 XXX 999,999.999 99,999.999999 999,999.99 
*1234567890 1234567890123456789012345678901234567890 XXX 999,999.999 99,999.999999 999,999.99 
*                                                        999,999.999               999,999.99

PUBLIC lnPag, R
LOCAL lcFile, lcProceso
lcFile = "PrdCosDet"
lcProceso = "Rep_PrdDet()"
lnPag = 0
R = 0
Imprimetexto(lcFile,lcProceso)
RETURN

PROCEDURE REP_PrdDet
LOCAL lcCodLin,lcCodArt,lcTipDoc,lcNroDoc,lcTipo
LOCAL lnCanArtDet,lnImpTotDet

@PROW(),PCOL() SAY CHR(27)+"C"+CHR(66) 
@PROW(),PCOL() SAY CHR(18)+CHR(15)

TIT_PrdDet()
SELE TmpRep
GO TOP
DO WHILE !EOF()
	lcCodLin = CodLin
	R = R + 1
	@R,001 SAY "Linea : "+CodLin+" "+IIF(SEEK(lcCodLin,"ArtLin","CodLin"),PADR(ArtLin.DesLin,40),"")
	R = R + 1
	DO WHILE !EOF() AND CodLin = lcCodLin
		lcCodArt = CodArt
		R = R + 1
		@R,001 SAY PADR(CodArt,10)
		@R,012 SAY PADR(DesArt,40)
		@R,053 SAY CodUnd
		R = R + 1
		DO WHILE !EOF() AND CodLin = lcCodLin AND CodArt = lcCodArt
			lcTipDoc = TipDoc
			lcNroDoc = NroDoc
			R = R + 1
			@R,001 SAY "ORD PRODUCCION :"
			@R,018 SAY PADR(NroDoc,12)
			*@R,033 SAY "FECHA :"
			*@R,041 SAY FecDoc
			R = R + 1
			@R,001 SAY "CANTIDAD PROD  :"
			@R,018 SAY CanArt PICTURE "999,999.999"
			@R,030 SAY CodUnd
			@R,035 SAY "FACTOR PROD   :"
			@R,050 SAY FacPrd PICTURE "999,999.999999"
			R = R + 1
			@R,001 SAY "CANTIDAD LINEA :"
			@R,018 SAY CanPrd PICTURE "999,999.999"
			@R,030 SAY UndPrd
			@R,035 SAY "TOTAL X LINEA :"
			@R,050 SAY CanPrdLin PICTURE "999,999.999"
			@R,062 SAY UndPrdLin
			R = R + 1
			@R,001 SAY "MATERIA PRIMA  :"
			@R,018 SAY ImpMP PICTURE "99,999,999.99"
			R = R + 1
			@R,001 SAY "MANO DE OBRA   :"
			@R,018 SAY ImpMO PICTURE "99,999,999.99"
			@R,035 SAY "TOTAL X LINEA :"
			@R,050 SAY ImpMOLin PICTURE "99,999,999.99"
			R = R + 1
			@R,001 SAY "GASTO FABRICAC :"
			@R,018 SAY ImpGF PICTURE "99,999,999.99"
			@R,035 SAY "TOTAL X LINEA :"
			@R,050 SAY ImpGFLin PICTURE "99,999,999.99"
			R = R + 1
			@R,001 SAY "TOTAL COSTO    :"
			@R,018 SAY ImpTot PICTURE "99,999,999.99"
			@R,035 SAY "COSTO X UND   :"
			@R,050 SAY ImpCos PICTURE "99,999,999.999999"
			R = R + 1
			@R,001 SAY "VENTA          :"
			@R,018 SAY ImpVta PICTURE "99,999,999.99"
			@R,035 SAY "UTILIDAD      :"
			@R,050 SAY ImpUti PICTURE "99,999,999.99"
			R = R + 1
			@R,001 SAY REPLICATE("-",130)
			R = R + 1
			@R,001 SAY "CODIGO"
			@R,012 SAY "DESCRIPCION"
			@R,053 SAY "UND"
			@R,057 SAY PADL("CANTIDAD",11)
			@R,069 SAY PADL("COSTO",15)
			@R,085 SAY PADL("TOTAL",11)
			@R,097 SAY "DOCUMENTO"
			@R,116 SAY "FECHA"
			*R = R + 1
			*@R,001 SAY REPLICATE("-",130)
			DO WHILE !EOF() AND CodLin = lcCodLin AND CodArt = lcCodArt AND TipDoc = lcTipDoc AND NroDoc = lcNroDoc
				R = R + 1
				IF R > 55
					TIT_PrdDet()
					R = R + 1
				ENDIF
				lcTipo = Tipo
				DO CASE
				CASE  lcTipo = "1"
					@R,001 SAY "MATERIA PRIMA"
				CASE  lcTipo = "2"
					@R,001 SAY "PRODUCTOS TERMINADOS"	
				CASE  lcTipo = "1"
					@R,001 SAY "VENTA"	
				OTHER
					@R,001 SAY ""	
				ENDCASE
				STORE 0 TO lnCanArtDet,lnImpTotDet
				DO WHILE !EOF() AND CodLin = lcCodLin AND CodArt = lcCodArt AND ;
				                TipDoc = lcTipDoc AND NroDoc = lcNroDoc AND Tipo = lcTipo
					R = R + 1
					IF R > 55
						TIT_PrdDet()
						R = R + 1
					ENDIF
					@R,001 SAY PADR(CodArtDet,10)
					@R,012 SAY PADR(DesArtDet,40)
					@R,053 SAY PADR(CodUndDet,3)
					@R,057 SAY CanArtDet PICTURE "@Z 999,999.999"
					@R,069 SAY ImpArtDet PICTURE "@Z 9999,999.999999"
					@R,085 SAY ImpTotDet PICTURE "@Z 9999,999.99"
					@R,097 SAY PADR(TipRefDet+"-"+NroRefDet,15)
					@R,116 SAY FecRefDet
					lnCanArtDet = lnCanArtDet + CanArtDet
					lnImpTotDet = lnImpTotDet + ImpTotDet
					SKIP
				ENDDO
				R = R + 1
				@R,057 SAY lnCanArtDet PICTURE "@Z 999,999.999"
				@R,085 SAY lnImpTotDet PICTURE "@Z 9999,999.99"
				R = R + 1
			ENDDO
			R = R + 1
			@R,001 SAY REPLICATE("-",130)
			R = R + 1
		ENDDO
	ENDDO
ENDDO
RETURN

PROCEDURE TIT_PrdDet()
LOCAL lnColumna,lnOldSele
lnOldSele = SELECT()
lnPag =lnPag + 1
IF lnPag > 1
	@00,00 SAY ""
ENDIF
@01,001 SAY PADR(TabPar.NomEmp,40)
@01,042 SAY PADC(pTitNom,146)
@01,190 SAY DATE()
@02,001 SAY PADR("RUC : "+TabPar.NroRuc,40)
@02,042 SAY PADC(pTitRng,146)
@02,190 SAY TIME()
@03,042 SAY PADC(pTitMnd,146)
@03,190 SAY lnPag PICTURE "@B 9999"
@04,001 SAY REPLICATE("=",200)
*@05,001 SAY "Codigo"*
*@05,012 SAY "Descripcion"
*@05,053 SAY "UND"
*@06,001 SAY REPLICATE("-",200)
R=7
RETURN